## 2026-02-02（月）

### 概要

EmailTemplate 導入と compose 画面への統合を中心に、配信フロー全体の整理を実施。

### 実施内容

- EmailTemplate / EmailCampaign の設計整理
  - Template は編集可能
  - Campaign 側は subject / body をスナップショットとして保持する方針に決定
- compose 画面の送信フロー実装
  - Contacts 複数選択 → compose 画面遷移
  - 件名・本文入力 → EmailCampaign 作成
  - EmailCampaignRecipient 作成（email 未設定は SKIPPED）
  - console sender による送信処理
  - result 画面へリダイレクト
- Campaign 履歴一覧機能
  - 検索（q）
  - status フィルタ
  - FAILED を上位表示
  - FAILED の TopN サマリー表示
- searchParams を Promise 前提で await する実装に統一
- 「userId が勝手に入る」問題の調査
  - Prisma / session / middleware を横断的に確認
  - 実際には userId は自動挿入されていないことを確認
